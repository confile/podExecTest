import java.io.File;

// The 'java' plugin must be applied before the 'j2objc' plugin
apply plugin: 'java'
apply plugin: 'eclipse'
apply plugin: myPlugin

sourceCompatibility = 1.7
version = '1.0'

buildscript {
  repositories {
      maven {
          url "https://plugins.gradle.org/m2/"
      }
  }
}

repositories {
    mavenCentral()
    flatDir {
      dirs 'lib'
    }
}

dependencies {
}




class MyTask extends DefaultTask {

      @TaskAction
      def task() {
        
        def xcodeProjectDir = "${project.projectDir}/../ios"
        
        try {
          project.exec {
            workingDir xcodeProjectDir
            executable "pod"
            args "install"
          }              
       }
       catch (Exception exception) {
         throw exception
       }
     }
      
}


class myPlugin implements Plugin<Project> {
  
      @Override
      void apply(Project project) {
          project.with {
            
            project.tasks.create(name: 'amyTask', type: MyTask) {
              description 'A Test Task'
           }
              
         }
      }
      
}